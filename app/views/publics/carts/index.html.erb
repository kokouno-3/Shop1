<br>
<br>
<br>
<h2>ショッピングカート</h2>
<%= link_to "カートを空にする", publics_carts_destroy_all_path, method: :delete, class: "btn btn-danger btn-sm" %>
<table class="table table-bordered">
  <thead class="thead-light">
  <tr>
    <th class="active">商品名</th>
    <th class="active">単価(税込)</th>
    <th class="active">数量</th>
    <th class="active">小計</th>
    <th class="active"></th>
    </tr>
  </thead>
  <tbody>
    <% @carts.each do |cart| %>
    <tr>
      <td>
        <%= cart.item.name %>
      </td>
      <td>
        <%= (cart.item.price.* 1.1).round.to_s(:delimited) %>
      </td>
      <td>
        <%= form_with model: cart, url: publics_cart_path(cart), method: :patch, local: true do |f| %>
        <%= f.text_field :amount, auto_focus: true, size:"3" %>
        <%= f.submit "変更", class: "btn btn-primary" %>
        <% end %>
        </td>
      <td><%= (cart.item.price.* 1.1.* cart.amount).round.to_s(:delimited) %></td>
      <td><%= link_to "削除する", publics_cart_path(cart), method: :delete, class: "btn btn-danger" %></td>
      <% sub_total = (cart.item.price.* 1.1.* cart.amount) %>
      <% @total += sub_total %>
    </tr>
    <% end %>
  </tbody>
  <table class="table table-bordered" style="width:350px;">
  <tbody>
    <tr>
    <td class="active", style="width: 150px;">
      合計金額
    </td>
    <td>
      <%= @total.round.to_s(:delimited) %>
    </td>
    </tr>
  </tbody>
  </table>
</table>

<%= link_to "買い物を続ける", root_path, class: "btn btn-primary" %>
<%= link_to "情報入力に進む", new_publics_order_path, class: "btn btn-success btn-lg" %>
